!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n=n||self).CallApp=t()}(this,function(){"use strict";function n(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function t(n,t){return n(t={exports:{}},t.exports),t.exports}function v(r,o,n){if(function(n){if("function"!=typeof n)throw TypeError(n+" is not a function!")}(r),void 0===o)return r;switch(n){case 1:return function(n){return r.call(o,n)};case 2:return function(n,t){return r.call(o,n,t)};case 3:return function(n,t,e){return r.call(o,n,t,e)}}return function(){return r.apply(o,arguments)}}function o(n){return"object"==typeof n?null!==n:"function"==typeof n}function r(n){if(!o(n))throw TypeError(n+" is not an object!");return n}function e(n){try{return!!n()}catch(n){return!0}}function y(n,t){return s.call(n,t)}var m=t(function(n){var t=n.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),b=t(function(n){var t=n.exports={version:"2.6.9"};"number"==typeof __e&&(__e=t)}),p=(b.version,!e(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),i=m.document,u=o(i)&&o(i.createElement),a=!p&&!e(function(){return 7!=Object.defineProperty(function(n){return u?i.createElement(n):{}}("div"),"a",{get:function(){return 7}}).a}),c=Object.defineProperty,f={f:p?Object.defineProperty:function(n,t,e){if(r(n),t=function(n,t){if(!o(n))return n;var e,r;if(t&&"function"==typeof(e=n.toString)&&!o(r=e.call(n)))return r;if("function"==typeof(e=n.valueOf)&&!o(r=e.call(n)))return r;if(!t&&"function"==typeof(e=n.toString)&&!o(r=e.call(n)))return r;throw TypeError("Can't convert object to primitive value")}(t,!0),r(e),a)try{return c(n,t,e)}catch(n){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(n[t]=e.value),n}},g=p?function(n,t,e){return f.f(n,t,function(n,t){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:t}}(1,e))}:function(n,t,e){return n[t]=e,n},s={}.hasOwnProperty,O="prototype",w=function(n,t,e){var r,o,i,u=n&w.F,a=n&w.G,c=n&w.S,f=n&w.P,s=n&w.B,l=n&w.W,p=a?b:b[t]||(b[t]={}),d=p[O],h=a?m:c?m[t]:(m[t]||{})[O];for(r in a&&(e=t),e)(o=!u&&h&&void 0!==h[r])&&y(p,r)||(i=o?h[r]:e[r],p[r]=a&&"function"!=typeof h[r]?e[r]:s&&o?v(i,m):l&&h[r]==i?function(r){function n(n,t,e){if(this instanceof r){switch(arguments.length){case 0:return new r;case 1:return new r(n);case 2:return new r(n,t)}return new r(n,t,e)}return r.apply(this,arguments)}return n[O]=r[O],n}(i):f&&"function"==typeof i?v(Function.call,i):i,f&&((p.virtual||(p.virtual={}))[r]=i,n&w.R&&d&&!d[r]&&g(d,r,i)))};w.F=1,w.G=2,w.S=4,w.P=8,w.B=16,w.W=32,w.U=64,w.R=128;function l(n){if(null==n)throw TypeError("Can't call method on  "+n);return n}function d(n){return T(l(n))}function h(n){return isNaN(n=+n)?0:(0<n?x:E)(n)}function _(n){return Object(l(n))}var k,j,S,C=w,M={}.toString,T=Object("z").propertyIsEnumerable(0)?Object:function(n){return"String"==function(n){return M.call(n).slice(8,-1)}(n)?n.split(""):Object(n)},E=Math.ceil,x=Math.floor,P=Math.min,I=Math.max,F=Math.min,U=t(function(n){var t="__core-js_shared__",e=m[t]||(m[t]={});(n.exports=function(n,t){return e[n]||(e[n]=void 0!==t?t:{})})("versions",[]).push({version:b.version,mode:"pure",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),Q=0,A=Math.random(),q=U("keys"),z=(k=!1,function(n,t,e){var r,o=d(n),i=function(n){return 0<n?P(h(n),9007199254740991):0}(o.length),u=function(n,t){return(n=h(n))<0?I(n+t,0):F(n,t)}(e,i);if(k&&t!=t){for(;u<i;)if((r=o[u++])!=r)return!0}else for(;u<i;u++)if((k||u in o)&&o[u]===t)return k||u||0;return!k&&-1}),R=q[S="IE_PROTO"]||(q[S]="Symbol(".concat(void 0===(j=S)?"":j,")_",(++Q+A).toString(36))),B="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),W=Object.keys||function(n){return function(n,t){var e,r=d(n),o=0,i=[];for(e in r)e!=R&&y(r,e)&&i.push(e);for(;t.length>o;)y(r,e=t[o++])&&(~z(i,e)||i.push(e));return i}(n,B)},L={f:Object.getOwnPropertySymbols},Y={f:{}.propertyIsEnumerable},G=Object.assign,H=!G||e(function(){var n={},t={},e=Symbol(),r="abcdefghijklmnopqrst";return n[e]=7,r.split("").forEach(function(n){t[n]=n}),7!=G({},n)[e]||Object.keys(G({},t)).join("")!=r})?function(n,t){for(var e=_(n),r=arguments.length,o=1,i=L.f,u=Y.f;o<r;)for(var a,c=T(arguments[o++]),f=i?W(c).concat(i(c)):W(c),s=f.length,l=0;l<s;)a=f[l++],p&&!u.call(c,a)||(e[a]=c[a]);return e}:G;C(C.S+C.F,"Object",{assign:H});var N=b.Object.assign,D=n(t(function(n){n.exports={default:N,__esModule:!0}})),K=n(t(function(n,t){t.__esModule=!0,t.default=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}}));C(C.S+C.F*!p,"Object",{defineProperty:f.f});function V(n,t,e){return $.defineProperty(n,t,e)}var $=b.Object,J=t(function(n){n.exports={default:V,__esModule:!0}});n(J);var X=n(t(function(n,t){t.__esModule=!0;var e,o=(e=J)&&e.__esModule?e:{default:e};function r(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,o.default)(n,r.key,r)}}t.default=function(n,t,e){return t&&r(n.prototype,t),e&&r(n,e),n}}));var Z,nn,tn,en;Z="keys",nn=function(){return function(n){return W(_(n))}},tn=(b.Object||{})[Z]||Object[Z],(en={})[Z]=nn(tn),C(C.S+C.F*e(function(){tn(1)}),"Object",en);var rn=b.Object.keys,on=n(t(function(n){n.exports={default:rn,__esModule:!0}}));function un(n,t){var e=n.path,r=n.param,o=t.buildScheme;if(void 0!==o)return o(n,t);var i=t.scheme,u=i.host,a=i.port,c=i.protocol,f=u?u+(a?":"+a:"")+"/":"",s=void 0!==r?on(r).map(function(n){return n+"="+r[n]}).join("&"):"";return c+"://"+f+e+(s?"?"+s:"")}function an(n,t){var e=t.outChain,r=un(n,t);void 0!==e&&e&&(r=e.protocol+"://"+e.path+"?"+e.key+"="+encodeURIComponent(r));return r}var cn=null;function fn(){var t=void 0;return"hidden"in document?"":(["webkit","moz","ms","o"].forEach(function(n){n+"Hidden"in document&&(t=n)}),t||!1)}function sn(n){window.top.location.href=n}function ln(n){cn||((cn=document.createElement("iframe")).frameborder="0",cn.style.cssText="display:none;border:0;width:0;height:0;",document.body.appendChild(cn)),cn.src=n}function pn(n,t){var e=function(){var n=fn();return!1!==n&&n+"visibilitychange"}(),r=setTimeout(function(){!function(){var n=fn();return!1!==n&&document[n?n+"Hidden":"hidden"]}()&&n()},t);e?document.addEventListener(e,function(){clearTimeout(r)}):window.addEventListener("pagehide",function(){clearTimeout(r)})}function dn(n){K(this,dn);this.options=D({timeout:2e3},n)}return X(dn,[{key:"generateScheme",value:function(n){return an(n,this.options)}},{key:"generateIntent",value:function(n){return function(n,t){var e=t.outChain,r=t.intent,o=t.fallback,i="#Intent;"+on(r).map(function(n){return n+"="+r[n]+";"}).join("")+"S.browser_fallback_url="+encodeURIComponent(o)+";end;",u=un(n,t);if(void 0!==e&&e){var a=t.outChain;return"intent://"+a.path+"?"+a.key+"="+encodeURIComponent(u)+i}return"intent://"+(u=u.slice(u.indexOf("//")+2))+i}(n,this.options)}},{key:"generateUniversalLink",value:function(n){return function(n,t){var e=t.universal;if(!e)return"";var r=e.host,o=e.pathKey,i=n.path,u=n.param,a=void 0!==u?on(u).map(function(n){return n+"="+u[n]}).join("&"):"";return"https://"+r+"?"+o+"="+i+(a?"&"+a:"")}(n,this.options)}},{key:"generateYingYongBao",value:function(n){return function(n,t){var e=an(n,t);return t.yingyongbao+"&android_schema="+encodeURIComponent(e)}(n,this.options)}},{key:"checkOpen",value:function(n){return pn(n,this.options.timeout)}},{key:"fallToAppStore",value:function(){var n=this;this.checkOpen(function(){sn(n.options.appstore)})}},{key:"fallToFbUrl",value:function(){var n=this;this.checkOpen(function(){sn(n.options.fallback)})}},{key:"fallToCustomCb",value:function(n){this.checkOpen(function(){n()})}},{key:"open",value:function(n){var t=function(){var n=window.navigator.userAgent||"",t=/android/i.test(n),e=/iphone|ipad|ipod/i.test(n);return{isAndroid:t,isIos:e,isWechat:/micromessenger\/([\d.]+)/i.test(n),isWeibo:/(weibo).*weibo__([\d.]+)/i.test(n),isQQ:/qq\/([\d.]+)/i.test(n),isQQBrowser:/(qqbrowser)\/([\d.]+)/i.test(n),isQzone:/qzone\/.*_qz_([\d.]+)/i.test(n),isOriginalChrome:/chrome\/[\d.]+ Mobile Safari\/[\d.]+/i.test(n)&&t,isSafari:/safari\/([\d.]+)$/i.test(n)&&e&&n.indexOf("Crios")<0&&0===n.indexOf("Mozilla")}}(),e=this.options,r=e.universal,o=e.appstore,i=e.logFunc,u=e.intent,a=n.callback,c=n.fallCall,f=void 0!==r,s=this.generateScheme(n),l=null;void 0!==i&&i(),t.isIos?t.isWechat||t.isQQ||t.isQQBrowser?sn(o):function(){var n=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return parseInt(n[1],10)}()<9?(ln(s),l=this.fallToAppStore):f?sn(this.generateUniversalLink(n)):(sn(s),l=this.fallToAppStore):t.isWechat?sn(this.generateYingYongBao(n)):t.isOriginalChrome?void 0!==u?sn(this.generateIntent(n)):(function(n){var t=document.createElement("a");t.setAttribute("href",n),t.style.display="none",document.body.appendChild(t),t.click()}(s),l=this.fallToFbUrl):(ln(s),l=this.fallToFbUrl),void 0===a?l&&(l=c||l).call(this):this.fallToCustomCb(a)}}]),dn});
